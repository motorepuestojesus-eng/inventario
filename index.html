<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargador de Inventario Pro - BCV</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen pb-20">

    <nav class="bg-slate-900 text-white p-4 sticky top-0 z-50 shadow-md">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold tracking-tight">MI INVENTARIO</h1>
            <div class="bg-emerald-600 px-4 py-2 rounded-lg flex items-center gap-3">
                <span class="text-xs font-bold">TASA BCV:</span>
                <input type="number" id="tasaBCV" value="36.50" step="0.01" oninput="actualizarPrecios()" 
                       class="bg-white text-slate-900 font-bold w-20 rounded px-2 outline-none text-center">
            </div>
        </div>
    </nav>

    <div class="max-w-6xl mx-auto p-4 md:p-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="lg:col-span-1">
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                <h2 class="text-lg font-bold mb-4 text-slate-800 border-b pb-2">Registrar Producto</h2>
                <form id="formProducto" class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase">Proveedor</label>
                        <input type="text" id="prov" required class="w-full p-2 border rounded mt-1 focus:ring-2 focus:ring-emerald-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase">Marca</label>
                        <input type="text" id="marca" required class="w-full p-2 border rounded mt-1 focus:ring-2 focus:ring-emerald-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase">Modelo</label>
                        <input type="text" id="modelo" required class="w-full p-2 border rounded mt-1 focus:ring-2 focus:ring-emerald-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase">Nombre del Producto</label>
                        <input type="text" id="nombre" required class="w-full p-2 border rounded mt-1 focus:ring-2 focus:ring-emerald-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase">Precio en Divisa ($)</label>
                        <input type="number" id="precio" step="0.01" required class="w-full p-2 border rounded mt-1 font-bold text-blue-600 focus:ring-2 focus:ring-emerald-500 outline-none">
                    </div>
                    <button type="submit" class="w-full bg-slate-800 text-white font-bold py-3 rounded-lg hover:bg-slate-700 transition">
                        Añadir al Inventario
                    </button>
                </form>
            </div>
        </div>

        <div class="lg:col-span-2 space-y-4">
            <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                <div class="p-4 bg-slate-100 border-b flex justify-between items-center">
                    <h2 class="font-bold text-slate-700 uppercase text-sm">Productos en Lista</h2>
                    <span id="totalItems" class="bg-slate-800 text-white px-3 py-1 rounded-full text-xs">0 items</span>
                </div>
                <div class="overflow-x-auto h-[500px] overflow-y-auto">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 sticky top-0 text-xs uppercase text-slate-500 font-bold border-b">
                            <tr>
                                <th class="p-3 text-center">#</th>
                                <th class="p-3">Info Producto</th>
                                <th class="p-3">Precio ($)</th>
                                <th class="p-3 bg-emerald-50 text-emerald-700">Precio (BS)</th>
                                <th class="p-3">Acción</th>
                            </tr>
                        </thead>
                        <tbody id="tablaBody">
                            </tbody>
                    </table>
                </div>
            </div>
            <button onclick="exportarJSON()" class="text-xs text-slate-400 hover:underline">Descargar Respaldo JSON</button>
        </div>
    </div>

    <script>
        let inventario = JSON.parse(localStorage.getItem('miInventario')) || [];

        const form = document.getElementById('formProducto');
        const tabla = document.getElementById('tablaBody');

        form.onsubmit = (e) => {
            e.preventDefault();
            const nuevo = {
                id: Date.now(),
                proveedor: document.getElementById('prov').value,
                marca: document.getElementById('marca').value,
                modelo: document.getElementById('modelo').value,
                nombre: document.getElementById('nombre').value,
                precio: parseFloat(document.getElementById('precio').value)
            };
            inventario.push(nuevo);
            guardarYMostrar();
            form.reset();
        };

        function actualizarPrecios() {
            guardarYMostrar();
        }

        function eliminar(id) {
            inventario = inventario.filter(p => p.id !== id);
            guardarYMostrar();
        }

        function guardarYMostrar() {
            localStorage.setItem('miInventario', JSON.stringify(inventario));
            const tasa = parseFloat(document.getElementById('tasaBCV').value) || 1;
            document.getElementById('totalItems').innerText = `${inventario.length} items`;
            
            tabla.innerHTML = "";
            inventario.forEach((p, index) => {
                const precioBS = (p.precio * tasa).toLocaleString('es-VE', { minimumFractionDigits: 2 });
                const tr = document.createElement('tr');
                tr.className = "border-b hover:bg-gray-50 text-sm";
                tr.innerHTML = `
                    <td class="p-3 text-center text-slate-400">${index + 1}</td>
                    <td class="p-3 leading-tight">
                        <div class="font-bold text-slate-800 uppercase">${p.nombre}</div>
                        <div class="text-[10px] text-slate-400">${p.marca} | ${p.modelo} | Prov: ${p.proveedor}</div>
                    </td>
                    <td class="p-3 font-mono text-blue-600">$${p.precio.toFixed(2)}</td>
                    <td class="p-3 font-bold text-emerald-600 bg-emerald-50/50">Bs. ${precioBS}</td>
                    <td class="p-3">
                        <button onclick="eliminar(${p.id})" class="text-red-400 hover:text-red-600">✕</button>
                    </td>
                `;
                tabla.appendChild(tr);
            });
        }

        function exportarJSON() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(inventario));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "mi_inventario.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }

        // Carga inicial
        guardarYMostrar();
    </script>
</body>
</html>
